<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Silverlight and the ConvertAll method</title>

  <meta name="author" content="Matt Ball" />
  
  

  <meta name="generator" content="Hugo 0.15" />

  <link rel="alternate" href="http://mattdrivendev.github.io/index.xml" type="application/rss+xml" title="strongly-typed">

  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="http://mattdrivendev.github.io/css/bootstrap.min.css" />
  <link rel="stylesheet" href="http://mattdrivendev.github.io/css/main.css" />
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="http://mattdrivendev.github.io/css/pygment_highlights.css" />
  
  
  <meta property="og:title" content="Silverlight and the ConvertAll method" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="/" />
  <meta property="og:image" content="" />
  
</head>


  <body>

    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://mattdrivendev.github.io/">strongly-typed</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
      
      </ul>
    </div>

	<div class="avatar-container">
	  <div class="avatar-img-border">
      
	  </div>
	</div>

  </div>
</nav>


    <div role="main" class="container main-content">

      
        





<header class="header-section ">

<div class="intro-header no-img">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-heading">
          <h1>Silverlight and the ConvertAll method</h1>
      
      
      
      <span class="post-meta">Posted on October 11, 2011</span>
      
        </div>
      </div>
    </div>
  </div>
</div>
</header>




<div class="container">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
          

<p>I may have already mentioned my woes (here or on Twitter) with the Linq2SQL in a Silverlight for Windows Phone Mango environment.</p>

<p>I am of the opinion that the following code should work:</p>

<pre><code>public class Person : IPerson
{   
    // Class internals, not relevant for this example.
}

public class DataContext
{
    public DataContext()
    {
        // Load data or whatever.
    }

    public Table&lt;Person&gt; People { get; set; }

    public IEnumerable&lt;IPerson&gt; GetPeople()
    {
        return this.People;
    }
}
</code></pre>

<p>I would have assumed this would work, because <code>Table&lt;T&gt;</code> implements the <code>IEnumerable&lt;T&gt;</code> interface and the contents of the Table, in this instance Person - implements the IPerson interface.</p>

<p>But apparently it wouldn&rsquo;t. I cannot recall now if it returned an <code>IEnumerable&lt;T&gt;</code> that was empty, or if it was just null. In either case it wasn&rsquo;t working.</p>

<p>So after a little investigation I found a blog post [1] showing you 4 increastingly better ways for doing what I wanted. However I could only get Method 1 to work, because Silverlight does not support the .ConvertAll method&hellip;</p>

<p>I cannot easily find any information why this method wouldn&rsquo;t be available in the Silverlight runtime, one quick read did suggest it was just something that was dropped to make the runtime more lightweight - which seems reasonable I guess, but it didn&rsquo;t seem too heavy an idea in my mind. But whatever.</p>

<p>So this is what I ended up with, hardly elegant - but it worked:</p>

<pre><code>	public class Person : IPerson
	{
	    // Class internals, not relevant for this example.
	}

	public class DataContext
	{
	    public DataContext()
	    {
	        // Load data or whatever.
	    }

	    public Table&lt;Person&gt; People { get; set; }

	    public IEnumerable&lt;IPerson&gt; GetPeople()
	    {
	        IEnumerable&lt;IPerson&gt; people = new List&lt;IPerson&gt;();
	        foreach (Person p in this.People)
	            ((List&lt;IPerson&gt;)people).Add(p as IPerson);

	        return people;
	    }
	}
</code></pre>

<p>Wanting a more elegant solution that didn&rsquo;t mean that I would be writing foreach loops in all of my Get methods - I went on the hunt for something to replace the .ConvertAll method. I found a cool littl blog post [2] that described creating a Silverlight array helper that would implement a static .ConvertAll method that could be used.</p>

<p>Following that as an example my code can now look like:</p>

<pre><code>public class Person : IPerson
{
    // Class internals, not relevant for this example.
}

public class DataContext
{
    public DataContext()
    {
        // Load data or whatever.
    }

    public Table&lt;Person&gt; People { get; set; }

    public IEnumerable&lt;IPerson&gt; GetPeople()
    {
        return ConvertAll&lt;Person, IPerson&gt;(this.People, new Converter&lt;Person, IPerson&gt;(p =&gt; (IPerson)p));
    }

    // A re-usable method to ConvertAll items in an IEnumerable... 
    // probably best if pulled out into a helper class.
    public static IEnumerable&lt;TOutput&gt; ConvertAll&lt;TInput, TOutput&gt;(IEnumerable&lt;TInput&gt; enumerable, Converter&lt;TInput, TOutput&gt; converter)
    {
        return (from item in enumerable select converter(item)).AsEnumerable&lt;TOutput&gt;();
    }
}
</code></pre>

<p>I&rsquo;ll be interested to see what kind of affect this might have on performance (the target platform for this Silverlight application is Windows Phone 7.5, so performance is important to keep things lightweight, fast and fluid). But I will cross that bridge when I come to it, in the meantime at least my code is cleaner.</p>

<h3 id="references:204050b783fe404cb8d0a597875f045e">References:</h3>

<p>[1] - <a href="http://devlicio.us/blogs/derik_whittaker/archive/2008/03/28/simple-way-to-convert-ienumerable-lt-entity-gt-to-list-lt-ientity-gt.aspx">http://devlicio.us/blogs/derik_whittaker/archive/2008/03/28/simple-way-to-convert-ienumerable-lt-entity-gt-to-list-lt-ientity-gt.aspx</a></p>

<p>[2] - <a href="http://michaelsync.net/2009/03/22/silverlight-3-array-helper">http://michaelsync.net/2009/03/22/silverlight-3-array-helper</a></p>

      </article>

      <ul class="pager blog-pager">
        
        <li class="previous">
          <a href="http://mattdrivendev.github.io/post/more-pbs/" data-toggle="tooltip" data-placement="top" title="More PBs">&larr; Previous Post</a>
        </li>
        
        
        <li class="next">
          <a href="http://mattdrivendev.github.io/post/testing-debt/" data-toggle="tooltip" data-placement="top" title="Testing Debt">Next Post &rarr;</a>
        </li>
        
      </ul>

      

    </div>
  </div>
</div>

      

    </div>

    <footer>
  <div class="container beautiful-jekyll-footer">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
          
          <li>
            <a href="https://github.com/MattDrivenDev" title="GitHub">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
		      
          <li>
            <a href="https://twitter.com/MattDrivenDev" title="Twitter">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
		      
		      
          <li>
            <a href="https://uk.linkedin.com/in/matt-ball-98120940" title="LinkedIn">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
	    	  
          
          

    		  <li>
      			<a href="http://mattdrivendev.github.io/index.xml" title="RSS">
      			  <span class="fa-stack fa-lg">
        				<i class="fa fa-circle fa-stack-2x"></i>
        				<i class="fa fa-rss fa-stack-1x fa-inverse"></i>
      			  </span>
      			</a>
    		  </li>		

        </ul>
        <p class="copyright text-muted">
    		  Matt Ball
    		  &nbsp;&bull;&nbsp;
    		  2016
    		  
    		  
    		  &nbsp;&bull;&nbsp;
    		  <a href="http://mattdrivendev.github.io/">strongly-typed</a>
    		  
  	    </p>
  	        
    		<p class="theme-by text-muted">
    		  Theme by
    		  <a href="http://deanattali.com/beautiful-jekyll/">beautiful-jekyll</a>
    		</p>
      </div>
    </div>
  </div>
</footer>

<script src="http://mattdrivendev.github.io/js/jquery-1.11.2.min.js"></script>
<script src="http://mattdrivendev.github.io/js/bootstrap.min.js"></script>
<script src="http://mattdrivendev.github.io/js/main.js"></script>



  </body>
</html>
